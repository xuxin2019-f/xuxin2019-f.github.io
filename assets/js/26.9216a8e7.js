(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{506:function(s,t,a){"use strict";a.r(t);var n=a(59),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"webpack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webpack"}},[s._v("#")]),s._v(" webpack")]),s._v(" "),a("h2",{attrs:{id:"概念-原理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念-原理"}},[s._v("#")]),s._v(" 概念&原理")]),s._v(" "),a("p",[s._v("webpack 实际上是一个模块打包工具，在 webpack 中，万物皆模块，它默认只识别 js 和 json 格式的文件，"),a("strong",[s._v("但它从配置的入口文件开始，从入口文件里识别模块依赖，分析项目结构")]),s._v("（由于 webpack2 开始支持 commonjs 和 es6 语法，所以不论模块依赖是用什么写的都可以自动分析并转换编译），"),a("strong",[s._v("利用 loader")]),s._v("将浏览器不能识别的模块和扩展语言转换编译成浏览器可识别的格式，递归地构建一个依赖关系图，包含应用程序需要的每个模块，将这些模块打包成一个或多个 bundle。"),a("strong",[s._v("打包成最终的文件，最终的文件中的模块实现是基于 webpack 自己实现的 webpack_require，把定义的模块内容挂载到 module.exports 上")]),s._v("所以最后打包的文件可以跑在浏览器中。")]),s._v(" "),a("h2",{attrs:{id:"手写-loader"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手写-loader"}},[s._v("#")]),s._v(" 手写 loader")]),s._v(" "),a("p",[s._v("用于模块解析，将模块原内容按需求转换成新内容。"),a("strong",[s._v("webpack 中所有内容皆模块 module")]),s._v("，但 webpack 默认只识别 js 和 json，其他模块需要在 module 下的 rules 配置 loader（比如 less-load 会把 less 语法转换成 css）")]),s._v(" "),a("p",[a("strong",[s._v("loader 执行规则：从右到左，从下到上")])]),s._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[s._v("比如解析less\nless-loader将less解析成css，css-loader解析css模块之间的关系，合并成一个css，style-loader将css-loader生成的东西以style挂载到页面的header中\nmodule:{ rules:[ { test:/\\.less$/,\nuse:['style-loader','css-loader','less-loader'] } ] }\n")])])]),a("p",[s._v("其实 loader 的原理就是一个函数（"),a("strong",[s._v("注意因为要用 this，这里不能是箭头函数")]),s._v("），参数就是要处理的模块，将模块处理好后再返回\n举例：")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//1.最简单版本：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// index.js")]),s._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// loader.js")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("exports")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 这里要用到this，所以需要声明式函数")]),s._v("\n  console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("this"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'req'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//2.配置参数：通过this.query获取")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("exports")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 配置文件：")]),s._v("\nmodules"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  rules"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      test"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[s._v("/\\.js$/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      loader"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" path"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("__dirname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./loader.js'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      options"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'req'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//3.返回多个信息：this.callback")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("exports")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//this.callback = {")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//err:Error|null,")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//content:string|Buffer,")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//sourceMap? :SourceMap,")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//meta?:any")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//4.处理异步事务:this.async")]),s._v("\nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("exports")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("source")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" callback "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("async")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" source"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("replace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("callback")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h2",{attrs:{id:"多入口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多入口"}},[s._v("#")]),s._v(" 多入口")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" module.exports = {\n  entry:{\n  // 每个入口都是一个chunk，每个入口名都是一个chunkname\n    name1:'./src/name1.js',\n    name2:'./src/name2.js'\n  },\n  output:{\n    path:path.resolve(__dirname,'./dist')\n  // name和chunkname对应， chunkhash与每一个chunk文件联系在一起，只有chunk文件改变，chunkhash才改变，如果不变，浏览器继续使用内容，起到优化的作用\n    filename:'[name]_[chunkhash:8].js',\n  }\n}\n")])])]),a("h2",{attrs:{id:"代码分离"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码分离"}},[s._v("#")]),s._v(" 代码分离")]),s._v(" "),a("p",[a("strong",[s._v("代码分割就是我们根据实际业务需求将代码进行分割，然后在合适的时候在将其加载进入文档中")])]),s._v(" "),a("p",[s._v("代码分离 code spliting https://webpack.docschina.org/guides/code-splitting/")]),s._v(" "),a("p",[s._v("代码分割教程https://www.jianshu.com/p/2cc8457f1a10")]),s._v(" "),a("p",[s._v("代码分离将不同的代码分离到不同的 bundle 中（"),a("strong",[s._v("比如把第三方模块分离出去")]),s._v("），控制资源加载优先级，获取更小的 bundle，极大提高加载速度")]),s._v(" "),a("p",[a("strong",[s._v("代码分离方式：")])]),s._v(" "),a("ul",[a("li",[s._v("入口起点配置：如果入口 chunk 之间包含一些重复的模块，那些重复模块都会被引入到各个 bundle 中")]),s._v(" "),a("li",[s._v("使用 SplitChunksPlugin 插件（这个插件不需要任何额外下载，直接在 webpack.config.js 下配置 optimization 即可），即 webpack 笔记里写的，此插件将所有公共的模块都抽离出去，提取到已有的 entry chunk 或一个新生成的 chunk。")])]),s._v(" "),a("p",[a("strong",[s._v("在这个插件的作用下：")])]),s._v(" "),a("p",[s._v("webpack 将根据以下条件自动拆分代码块：")]),s._v(" "),a("ul",[a("li",[s._v("会被共享的代码块或者 node_mudules 文件夹中的代码块")]),s._v(" "),a("li",[s._v("体积大于 30KB 的代码块（在 gz 压缩前）")]),s._v(" "),a("li",[s._v("按需加载代码块时的并行请求数量不超过 5 个")]),s._v(" "),a("li",[s._v("加载初始页面时的并行请求数量不超过 3 个")])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("optimization: {\n     splitChunks: {\n       chunks: 'all'\n     }\n   }\n")])])]),a("p",[s._v("splitChunks 的一些特殊选项及其默认值：")]),s._v(" "),a("p",[s._v("miniSize:30000,最小尺寸，当模块大于 30kb")]),s._v(" "),a("p",[s._v("minChunks：1 打包生成的 chunk 文件最少有几个 chunk 引用了这个模块")]),s._v(" "),a("p",[s._v("maxAsyncRequests：5 动态加载请求（异步请求数）")]),s._v(" "),a("p",[s._v("maxInitialRequests：3 最大初始化请求数")]),s._v(" "),a("p",[a("strong",[s._v("chunks(选择分割哪些代码)：默认 async（按需加载的代码），all（全部代码），initial（页面初始化的代码）")])]),s._v(" "),a("p",[s._v("以下是由社区提供，一些对于代码分离很有帮助的 plugin 和 loader：")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://webpack.docschina.org/plugins/mini-css-extract-plugin",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("mini-css-extract-plugin")]),a("OutboundLink")],1),s._v("：用于将 CSS 从主应用程序中分离。")]),s._v(" "),a("li",[a("a",{attrs:{href:"https://webpack.docschina.org/loaders/bundle-loader",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("bundle-loader")]),a("OutboundLink")],1),s._v("：用于分离代码和延迟加载生成的 bundle。")]),s._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/gaearon/promise-loader",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("promise-loader")]),a("OutboundLink")],1),s._v("：类似于 "),a("code",[s._v("bundle-loader")]),s._v(" ，但是使用了 promise API。")])]),s._v(" "),a("h4",{attrs:{id:"按需加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#按需加载"}},[s._v("#")]),s._v(" 按需加载")]),s._v(" "),a("p",[s._v("即"),a("strong",[s._v("动态导入")]),a("a",{attrs:{href:"https://webpack.docschina.org/guides/code-splitting/#%E5%8A%A8%E6%80%81%E5%AF%BC%E5%85%A5-dynamic-imports-",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://webpack.docschina.org/guides/code-splitting/#%E5%8A%A8%E6%80%81%E5%AF%BC%E5%85%A5-dynamic-imports-"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("输出 output 选项添加 chunkFilename：'[name].bundle.js'，作用是决定非入口 chunk 的名称")]),s._v(" "),a("p",[s._v("利用动态导入，比如：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("return import(/* webpackChunkName: \"lodash\" */ 'lodash').then(({ default: _ }) => {。。。。\n在注释中提供了webpackChunkName，这样会将拆分出来的bundle命名为lodash.bundle.js。\n")])])]),a("h4",{attrs:{id:"预取和预加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#预取和预加载"}},[s._v("#")]),s._v(" 预取和预加载")]),s._v(" "),a("p",[a("strong",[s._v("在动态导入的时候以注释的方式开启即可")]),s._v("，表明这个模块是异步加载的，并且对它开启了预取")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("import(/* webpackPrefetch: true */ 'LoginModal');\n")])])]),a("h2",{attrs:{id:"代码压缩"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代码压缩"}},[s._v("#")]),s._v(" 代码压缩")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.im/post/5e8b1b6951882573c04ccd86",target:"_blank",rel:"noopener noreferrer"}},[s._v("代码压缩文档"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"tree-shaking"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tree-shaking"}},[s._v("#")]),s._v(" tree shaking")]),s._v(" "),a("p",[s._v("摇树将未被使用（即没有被 import"),a("strong",[s._v("按需")]),s._v("引入的）的 exported member 标记为 unusage，并使它不再 export")]),s._v(" "),a("p",[s._v("注意副作用！！比如 css 等文件实际上是直接 import 导入，"),a("strong",[s._v("而不是按需导入的")]),s._v("，需要额外配置")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//package.json")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//"sideEffects":false正常对所有模块进⾏tree shaking')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 改为对某些特定模块不进行摇树")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sideEffects"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*.css'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*.less'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'*.png'")]),s._v("，’@babel"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ployfill"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),a("p",[s._v("sideEffects 为副作用，在什么都不设置的情况下，即使模块没有被按需导入，如果该模块里存在副作用代码，该部分代码仍会被保留下来，这样摇树后的项目体积并没有很好的减小，所以在可以全局摇树的情况下，可以直接设置'sideEffetcs':false")]),s._v(" "),a("h3",{attrs:{id:"_8-hmr-热模块替换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-hmr-热模块替换"}},[s._v("#")]),s._v(" 8.HMR 热模块替换")]),s._v(" "),a("h3",{attrs:{id:"_9-babel（重要）"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-babel（重要）"}},[s._v("#")]),s._v(" 9.Babel（重要）")]),s._v(" "),a("p",[s._v("把 es6、es7、es8 转换为 es5 格式")]),s._v(" "),a("p",[s._v("重要看下@babel/polyfill 和@babel/plugin-transform-runtime 的作用")]),s._v(" "),a("h3",{attrs:{id:"_10-webpack-merge"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-webpack-merge"}},[s._v("#")]),s._v(" 10.webpack-merge")]),s._v(" "),a("p",[s._v("见 webpack 笔记，分为两种方式")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("下载引入 webpack-merge，分别建立 webpack.base.js,webpack.dev.js,webpack.pro.js,"),a("strong",[s._v("用 merge 分别在 dev 和 pro 的 js 文件夹中合并 base")]),s._v("，然后在 package.json 中写 build 和 dev 两个脚本分别引用，注意：dev 开发模式需要先经过服务器，所以写法是")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"scripts"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webpack --config ./webpack.pro.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注意：开发环境需要先经过服务器才行，所以需要写webpack-dev-server(模拟接口写在了server.js里)，这是原来server的配置")]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dev"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"webpack-dev-server --config ./webpack.dev.js"')]),s._v("\n     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// \"server\":'webpack-dev-server'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])])]),s._v(" "),a("li",[a("p",[s._v("在 base.js 中引入 dev.js 和 pro.js，在 scripts 脚本中，给生成环境加变量 env.production，根据这个变量在 base.js 判断是否存在，如果存在则 merge pro.js，负责合并 dev.js")])])]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(' "scripts": {\n    "test": "echo \\"Error: no test specified\\" && exit 1",\n    "base_build": "webpack --env.production --config ./webpack.base.js",\n    "base_dev": "webpack --config ./webpack.base.js"\n  },\n\n  // base.js\n  module.exports = env => {\n  if (env && env.production) {\n    return merge(commonConfig, prodConfig);\n  } else {\n    return merge(commonConfig, devConfig);\n  }\n};\n')])])]),s._v(" "),a("comment"),s._v(" "),a("comment"),s._v(" "),a("comment"),s._v(" "),a("comment"),s._v(" "),a("comment"),s._v(" "),a("comment"),s._v(" "),a("comment"),s._v(" "),a("comment"),s._v(" "),a("comment"),s._v(" "),a("comment"),s._v(" "),a("comment")],1)}),[],!1,null,null,null);t.default=e.exports}}]);