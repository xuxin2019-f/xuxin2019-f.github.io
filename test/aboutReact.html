<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React 相关 | xx的博客</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="./2.jpg">
    <meta name="description" content="Welcome">
    <link rel="preload" href="/assets/css/0.styles.8b57ca07.css" as="style"><link rel="preload" href="/assets/js/app.b7abec6d.js" as="script"><link rel="preload" href="/assets/js/2.abe78d93.js" as="script"><link rel="preload" href="/assets/js/18.a8bc42d5.js" as="script"><link rel="preload" href="/assets/js/5.f990928a.js" as="script"><link rel="prefetch" href="/assets/js/10.9cf6598d.js"><link rel="prefetch" href="/assets/js/11.df34b82f.js"><link rel="prefetch" href="/assets/js/12.7fb2abf1.js"><link rel="prefetch" href="/assets/js/13.d1e87d6e.js"><link rel="prefetch" href="/assets/js/14.cd14ebb0.js"><link rel="prefetch" href="/assets/js/15.c890b1b1.js"><link rel="prefetch" href="/assets/js/16.8bda8f59.js"><link rel="prefetch" href="/assets/js/17.271cb451.js"><link rel="prefetch" href="/assets/js/19.865cf1bf.js"><link rel="prefetch" href="/assets/js/20.f61f8be2.js"><link rel="prefetch" href="/assets/js/21.ec8aee77.js"><link rel="prefetch" href="/assets/js/22.d64a6ba2.js"><link rel="prefetch" href="/assets/js/23.2fe942e0.js"><link rel="prefetch" href="/assets/js/24.2cb8cadf.js"><link rel="prefetch" href="/assets/js/25.e14bc8c3.js"><link rel="prefetch" href="/assets/js/26.9216a8e7.js"><link rel="prefetch" href="/assets/js/3.3faae2d7.js"><link rel="prefetch" href="/assets/js/4.be82c51c.js"><link rel="prefetch" href="/assets/js/6.d1da093d.js"><link rel="prefetch" href="/assets/js/7.59fc17b1.js"><link rel="prefetch" href="/assets/js/8.220bb62b.js"><link rel="prefetch" href="/assets/js/9.28a30f0e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8b57ca07.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">xx的博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/reading/" class="nav-link">
  最近阅读
</a></div><div class="nav-item"><a href="/test/" class="nav-link router-link-active">
  面试题
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于我
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="联系方式" class="dropdown-title"><span class="title">联系方式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ins/" class="nav-link">
  Ins
</a></li><li class="dropdown-item"><!----> <a href="/wechat/" class="nav-link">
  微信
</a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/xuxin2019f" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gittee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/xuxin2019-f" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/reading/" class="nav-link">
  最近阅读
</a></div><div class="nav-item"><a href="/test/" class="nav-link router-link-active">
  面试题
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  关于我
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="联系方式" class="dropdown-title"><span class="title">联系方式</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ins/" class="nav-link">
  Ins
</a></li><li class="dropdown-item"><!----> <a href="/wechat/" class="nav-link">
  微信
</a></li><li class="dropdown-item"><!----> <a href="https://gitee.com/xuxin2019f" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Gittee
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/xuxin2019-f" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/test/" aria-current="page" class="sidebar-link">CSS 相关</a></li><li><a href="/test/aboutHtml.html" class="sidebar-link">HTML 相关</a></li><li><a href="/test/aboutjs.html" class="sidebar-link">js 相关</a></li><li><a href="/test/web.html" class="sidebar-link">浏览器</a></li><li><a href="/test/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/test/safety.html" class="sidebar-link">网络安全</a></li><li><a href="/test/aboutVue.html" class="sidebar-link">Vue 相关</a></li><li><a href="/test/aboutReact.html" aria-current="page" class="active sidebar-link">React 相关</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_1-针对每个组件根节点问题的解决" class="sidebar-link">1.针对每个组件根节点问题的解决</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_2-setstate-特性" class="sidebar-link">2.setState 特性</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_3-react-中实现数据绑定" class="sidebar-link">3.react 中实现数据绑定</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_4-hook" class="sidebar-link">4.hook</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_5-什么是-hoc，和-mixins-的对比有什么优点？" class="sidebar-link">5.什么是 HOC，和 mixins 的对比有什么优点？</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_6-react-性能优化" class="sidebar-link">6.react 性能优化</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_7-什么是-flux" class="sidebar-link">7.什么是 Flux</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_8-mobx-和-redux-的区别" class="sidebar-link">8.mobx 和 redux 的区别</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_9-react-router-原理" class="sidebar-link">9.react-router 原理</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_10-react-中组件通信" class="sidebar-link">10.react 中组件通信</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_11-refs-的作用" class="sidebar-link">11.refs 的作用</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_12-createelement-和-cloneelement-的区别" class="sidebar-link">12.createElement 和 cloneElement 的区别</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_13-如何告诉-react-它应该是编译生产环境版本" class="sidebar-link">13.如何告诉 react 它应该是编译生产环境版本</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_14-react-中-key-的作用" class="sidebar-link">14.react 中 key 的作用</a></li><li class="sidebar-sub-header"><a href="/test/aboutReact.html#_15-react-中-state-和-props-的区别" class="sidebar-link">15.react 中 state 和 props 的区别</a></li></ul></li><li><a href="/test/math.html" class="sidebar-link">算法相关</a></li><li><a href="/test/git.html" class="sidebar-link">git 相关</a></li><li><a href="/test/aboutTs.html" class="sidebar-link">关于 TS</a></li><li><a href="/test/test.html" class="sidebar-link">总结的面试题</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="react-相关"><a href="#react-相关" class="header-anchor">#</a> React 相关</h1> <p>http://assets.processon.com/chart_image/5e9c6a8263768974667ee066.png?_=1594459993277</p> <h2 id="_1-针对每个组件根节点问题的解决"><a href="#_1-针对每个组件根节点问题的解决" class="header-anchor">#</a> 1.针对每个组件根节点问题的解决</h2> <p>由于每个组件都有根节点 div
当多组件套用时会形成许多不需要的 div 盒子，很冗杂
解决方案：</p> <ol><li><div class="language-html extra-class"><pre class="language-html"><code>通用，且更灵活 render() { return
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>React.Fragment</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
  .....
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>React.Fragment</span><span class="token punctuation">&gt;</span></span>
}
</code></pre></div></li> <li><div class="language-html extra-class"><pre class="language-html"><code>在react16以后支持编写[] render() { return [
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
..... ] }
</code></pre></div></li></ol> <h2 id="_2-setstate-特性"><a href="#_2-setstate-特性" class="header-anchor">#</a> 2.setState 特性</h2> <p>setState 里可以是一个对象，也可以是一个函数，函数的第一个参数是上一次更新后的 state，第二个参数是子组件接收的 props</p> <ul><li>它是批量的
当 setState 后，更新器会将 nextState 存放到一个待处理状态数组中，便于之后批量的操作。在更新的时候会调用一个 shouldUpdate 函数，接收 instance 实例、props 属性、state 状态、上下文等来进行更新，其中会把待处理状态数组中的所有 state 合并成一次 state 执行一次更新，从而实现批量。<strong>值得注意的是，在 getState 中，如果遍历到待处理状态数组中的某一个 state 是函数类型的，则直接调用实例来执行，从而实现直接拿到上一次的值进行修改。</strong>
多个以对象形式更新的 setState 会合并成一个，<strong>因此推荐用 function 来更新</strong></li> <li>它是异步的
setState 调用后，会将更新器任务压入更新队列中在等待系统批量更新 batchUpdate。React 中，封装的合成事件以及生命钩子函数中都会触发 batchUpdate 批量操作函数，实现 setState 的异步操作，为的是避免频繁的操作导致频繁的 vdom 对比、diff 操作、页面重绘，影响性能。而在原生事件和定时器中，则不会触发 batchUpdate 函数，此时 setState 是同步的
<strong>如果想要拿到刚修改的参数，使用 setState 的第二个参数函数</strong></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 假如couter初始值为0，执行三次以后其结果是多少？</span>
    <span class="token comment">// 若同一个key多次出现，最后那个起作用</span>
    <span class="token comment">// this.setState({ counter: this.state.counter + 1 }, ()=&gt;{</span>
    <span class="token comment">//     console.log(this.state.counter); // 1</span>
    <span class="token comment">// });</span>
    <span class="token comment">// this.setState({ counter: this.state.counter + 1 }, ()=&gt;{</span>
    <span class="token comment">//     console.log(this.state.counter); // 1</span>
    <span class="token comment">// });</span>
    <span class="token comment">// this.setState({ counter: this.state.counter + 1 }, ()=&gt;{</span>
    <span class="token comment">//     console.log(this.state.counter); // 1</span>
    <span class="token comment">// });</span>
    这个回调函数会在值全部更新完才执行

    或者直接用函数的形式执行：
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span>props</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>拿到最新的值<span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>
      <span class="token parameter">nextState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>nextState<span class="token punctuation">.</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> counter<span class="token operator">:</span> nextState<span class="token punctuation">.</span>counter <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>
      <span class="token parameter">nextState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>nextState<span class="token punctuation">.</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> counter<span class="token operator">:</span> nextState<span class="token punctuation">.</span>counter <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span>
      <span class="token parameter">nextState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>nextState<span class="token punctuation">.</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span> counter<span class="token operator">:</span> nextState<span class="token punctuation">.</span>counter <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 2</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>counter<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 3</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    所有的回调函数都是在所有state更新后才执行的，所以都是<span class="token number">3</span>
</code></pre></div><h2 id="_3-react-中实现数据绑定"><a href="#_3-react-中实现数据绑定" class="header-anchor">#</a> 3.react 中实现数据绑定</h2> <div class="language- extra-class"><pre><code>``` js
&lt; input type='text' value={this.state.num} onChange={(e)=&gt;this.setState({num:e.target.value})} /&gt;
```
</code></pre></div><h2 id="_4-hook"><a href="#_4-hook" class="header-anchor">#</a> 4.hook</h2> <p>为无状态的函数组件赋予状态， 使用了 JavaScript 的闭包机制，而不用在 JavaScript 已经提供了解决方案的情况下，还引入特定的 React API。</p> <ul><li>useState</li> <li>useEffect (在不传第二个参数的情况下每次渲染时都执行，传第二个参数可以实现性能优化)</li> <li>useContext</li> <li>useReducer</li></ul> <h2 id="_5-什么是-hoc，和-mixins-的对比有什么优点？"><a href="#_5-什么是-hoc，和-mixins-的对比有什么优点？" class="header-anchor">#</a> 5.什么是 HOC，和 mixins 的对比有什么优点？</h2> <ol><li>为了提高组件的复用率，就要保证组件功能单一性，若要满足复杂需求就需要扩展功能单一的组件，于是有了 HOC 高阶组件。高阶组件是一个工厂函数，它接收一个组件，扩展它的功能后返回这个全新的组件(不改变组件原型)</li> <li>对比</li></ol> <ul><li>mixins 会导致依赖不明确
mixin 会调用组件内部方法/数据，组件会调用 mixin 方法/数据, 无法保证双方方法稳定存在.
多个 mixin 同时作用时，依赖关系对于被 mixin 的组件来说会更困惑</li> <li>mixins 会造成命名冲突
多个 mixins 和组件本身的方法名称会有命名冲突的风险(但是高阶组件可能也会导致和 props 有命名冲突)</li> <li>vue3.0 中引入了组合式 API，较好解决了 HOC 和 mixins 的缺点，组合式 API 是十分灵活的。一个组合函数仅依赖它的参数和 Vue 全局导出的 API，而不是依赖其微妙的 this 上下文。你可以将组件内的任何一段逻辑导出为函数以复用它。你甚至可以通过导出整个 setup 函数达到和 extends 等价的效果。
https://composition-api.vuejs.org/zh/#%E4%BB%A3%E7%A0%81%E7%BB%84%E7%BB%87</li></ul> <h2 id="_6-react-性能优化"><a href="#_6-react-性能优化" class="header-anchor">#</a> 6.react 性能优化</h2> <ol><li>shouldComponentUpdate(nextProps,nextState){
做判断
}
在处理深层嵌套对象的时候需要用到 immutablejs 实现不可变的数据
在 react 中使用：</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token function">Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
     num<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
     title<span class="token operator">:</span><span class="token function">Map</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//某个修改参数的函数</span>
<span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'num'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'num'</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//获取state的某个数据用get</span>
 <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">return</span><span class="token punctuation">(</span>
       <span class="token operator">&lt;</span>Demo num<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'num'</span><span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token punctuation">)</span>
 <span class="token punctuation">}</span>


 <span class="token comment">//在子组件的shouldComponentUpdate比较时使用immutablejs提供的is方法进行比较：</span>
 <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span>
     <span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span><span class="token parameter">nextProps<span class="token punctuation">,</span>nextState</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
         <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">is</span><span class="token punctuation">(</span>nextProps<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span><span class="token operator">&amp;&amp;</span><span class="token function">is</span><span class="token punctuation">(</span>nextState<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">)</span>
     <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li><p>PureComponent
PureComponent 中的 shouldComponentUpdate<strong>仅作浅比较</strong>，只比较第一层，仅在 props 和 state 较为简单时才是用，在深层比较时调用 **forceUpdate(）（不推荐）**来确保组件被正确地更新。你也可以考虑使用 **immutable 对象（推荐）**加速嵌套数据的比较。</p></li> <li><p>React.memo
<code>React.memo</code> 为高阶组件。它与 <code>React.PureComponent</code> 非常相似，但只适用于函数组件，而不适用 class 组件。<code>React.memo</code> 仅检查 props 变更。如果函数组件被 <code>React.memo</code> 包裹，且其实现中拥有 useState 或 useContext 的 Hook，当 context 发生变化时，它仍会重新渲染。</p></li></ol> <p>即修改成：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> Child <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">memo</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'child render'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span>props<span class="token punctuation">.</span>pnum<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="4"><li>useCallback、useEffect、useMemo 的优化</li> <li>函数绑定的优化
第一种绑定方式，每一次 render 都会重新 bind 一次</li></ol> <p>​ 第二种绑定方式，每一次 render 都生成一个新的函数</p> <div class="language-react extra-class"><pre class="language-text"><code>&lt;button onClick={this.handleClick.bind(this)} /&gt;
&lt;button onClick={()=&gt;this.handleClick()} /&gt;
</code></pre></div><p><strong>推荐的写法：在 constructor 中绑定 this，这样只会在初始化的时候执行一次</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><ol start="6"><li>动画的优化
传统动画有 css 动画和 js 动画两种。css 提供动画 api，动画效果简单但能提高性能；js 动画是通过直接操作 dom 实现的，可以实现复杂动画，但是操作 dom 引起重排并影响性能。</li></ol> <p><strong>react 提供不操作 dom 的一种动画解决方案：ReactCssTransitionGroup</strong></p> <p>**或者使用蚂蚁金服的 Ant Motion ** https://motion.ant.design/index-cn</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//安装： npm install rc-queue-anim --save</span>
</code></pre></div><p>实现聊天页进场时的动画效果：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//chat.js</span>
<span class="token keyword">import</span> QueueAnim <span class="token keyword">from</span> <span class="token string">'rc-queue-anim'</span><span class="token punctuation">;</span>
 <span class="token operator">&lt;</span>QueueAnim delay<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">100</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token punctuation">{</span>chatmsgs<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> avatar <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../img/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>users<span class="token punctuation">[</span>v<span class="token punctuation">.</span>from<span class="token punctuation">]</span><span class="token punctuation">.</span>avatar<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.png</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
          <span class="token keyword">return</span> v<span class="token punctuation">.</span>from <span class="token operator">===</span> user <span class="token operator">?</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>List key<span class="token operator">=</span><span class="token punctuation">{</span>v<span class="token punctuation">.</span>_id<span class="token punctuation">}</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>Item thumb<span class="token operator">=</span><span class="token punctuation">{</span>avatar<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>v<span class="token punctuation">.</span>content<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>Item<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token operator">&gt;</span>
          <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>List key<span class="token operator">=</span><span class="token punctuation">{</span>v<span class="token punctuation">.</span>_id<span class="token punctuation">}</span><span class="token operator">&gt;</span>
              <span class="token operator">&lt;</span>Item extra<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>avatar<span class="token punctuation">}</span> alt<span class="token operator">=</span><span class="token string">&quot;&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span> className<span class="token operator">=</span><span class="token string">&quot;chat-me&quot;</span><span class="token operator">&gt;</span>
                <span class="token punctuation">{</span>v<span class="token punctuation">.</span>content<span class="token punctuation">}</span>
              <span class="token operator">&lt;</span><span class="token operator">/</span>Item<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>List<span class="token operator">&gt;</span>
          <span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>QueueAnim<span class="token operator">&gt;</span>
</code></pre></div><p><strong>每个子标签必须带 key，如果未设置 key 将不执行动画。</strong></p> <h2 id="_7-什么是-flux"><a href="#_7-什么是-flux" class="header-anchor">#</a> 7.什么是 Flux</h2> <p>Flux 是一种思想，把一个应用分为 4 个部分：</p> <ul><li>View 视图（vue、react...），根据 store 里的数据的改变而改变</li> <li>store 存储数据 Flux 规定一个应用可以有多个 store</li> <li>Dispatcher 接收 action 转发给 store 来进行数据的修改</li> <li>action view 中通过触发 action 来修改 store 里的数据</li></ul> <p><img src="https://user-gold-cdn.xitu.io/2018/12/18/167c11c13ef4e9a8?imageView2/0/w/1280/h/960/ignore-error/1" alt="image.png | center | 827x250"></p> <p><strong>Flux 最大的特点就是数据都是单向流动的，组件不允许直接修改属于 store 实例的 state，必须通过 action 来修改，而 store 里的 state 的改变也只能通过 action</strong></p> <h2 id="_8-mobx-和-redux-的区别"><a href="#_8-mobx-和-redux-的区别" class="header-anchor">#</a> 8.mobx 和 redux 的区别</h2> <ul><li>mobx 可以有多个 store，redux 只有一个 store</li> <li>mobx 没有 reducer 的概念，redux 中可以有多个 reducer 来判断 action 来修改 state</li> <li>mobx 可以直接修改 state，redux 中 state 不能直接操作，需要在原来的基础上返回新值</li> <li>mobx 没有中间件的概念，redux 中依靠中间件来强化 dispatch 和实现异步操作</li></ul> <h2 id="_9-react-router-原理"><a href="#_9-react-router-原理" class="header-anchor">#</a> 9.react-router 原理</h2> <ul><li>BrouserRouter 向下子组件传递 history、match、location,并利用 this.props.children 显示子内容</li> <li>Route 组件从 this.props 中解构出三个函数：children，component，render（条件渲染）,优先级：children&gt;component&gt;render，都接收一个函数作为参数，都可以使用 history、match、location</li> <li>Link 组件实际是对 a 标签的再次封装</li></ul> <h2 id="_10-react-中组件通信"><a href="#_10-react-中组件通信" class="header-anchor">#</a> 10.react 中组件通信</h2> <ol><li>父向子
通过 props</li> <li>子向父
通过触发父向子传递的函数：this.props.handle(xxx)</li> <li>非父子组件
Event bus 原理：发布订阅
实现一个事件总线</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 传递方:EventBus.emit('handle',2)</span>
<span class="token comment">// 接受方:EventBus.on('handle',(val)=&gt;{....})</span>
<span class="token keyword">class</span> <span class="token class-name">EventBus</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>_events <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">on</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token keyword">in</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>event<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> fn<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">[</span>event<span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">[</span>event<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">emit</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> cbs <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_events<span class="token punctuation">[</span>event<span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>cbs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      cbs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">fn</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> bus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventBus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
bus<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'handle'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span>
bus<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'handle'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> val<span class="token punctuation">)</span><span class="token punctuation">)</span>
bus<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">'handle'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><ol start="4"><li>复杂情况
redux/mobx</li></ol> <h2 id="_11-refs-的作用"><a href="#_11-refs-的作用" class="header-anchor">#</a> 11.refs 的作用</h2> <p>用来操作 dom 和实现子组件的转发</p> <ul><li>操作 dom</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 类组件</span>
 <span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">{</span>
   <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>myRef <span class="token operator">=</span> <span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token function-variable function">focus</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span>myRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
   <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
     <span class="token keyword">return</span> <span class="token punctuation">(</span>
       <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span>Input ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>myRef<span class="token punctuation">}</span><span class="token operator">&gt;</span>
         <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>focus<span class="token punctuation">}</span><span class="token operator">&gt;</span>
       <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
     <span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code> <span class="token comment">// 函数组件</span>
 <span class="token keyword">function</span> <span class="token function">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> textInput <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    textInput<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input
        type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span>
        ref<span class="token operator">=</span><span class="token punctuation">{</span>textInput<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input
        type<span class="token operator">=</span><span class="token string">&quot;button&quot;</span>
        value<span class="token operator">=</span><span class="token string">&quot;Focus the text input&quot;</span>
        onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span>
      <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
</code></pre></div><p><strong>注意</strong></p> <p>ref 的值根据节点的类型而有所不同：</p> <ul><li><p>当 <code>ref</code> 属性用于 HTML 元素时，构造函数中使用 <code>React.createRef()</code> 创建的 <code>ref</code> 接收底层 DOM 元素作为其 <code>current</code> 属性。</p></li> <li><p>当 <code>ref</code> 属性用于自定义 class 组件时，<code>ref</code> 对象接收组件的挂载实例作为其 <code>current</code> 属性。</p></li> <li><p><strong>你不能在函数组件上使用 <code>ref</code> 属性</strong>，因为他们没有实例。但可以在函数组件内部使用 ref 属性，只要将它指向一个 DOM 元素或者 class 组件（<strong>使用 useRef</strong>）</p></li> <li><p>转发
向父组件暴露子组件的 dom</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> FancyButton <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> ref<span class="token operator">=</span><span class="token punctuation">{</span>ref<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// const inputRef = React.createRef()</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> inputRef <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//此时inputRef.current指向input</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>inputRef<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>FancyButton ref<span class="token operator">=</span><span class="token punctuation">{</span>inputRef<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_12-createelement-和-cloneelement-的区别"><a href="#_12-createelement-和-cloneelement-的区别" class="header-anchor">#</a> 12.createElement 和 cloneElement 的区别</h2> <ul><li>createElement
构建一个 react 元素</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span> <span class="token punctuation">[</span>props<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>children<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>type 是一个标签名，如：div、p，或者 React 组件。
props 为传入的属性
第三个以及之后的参数 children，皆作为组件的子组件。</p> <ul><li>cloneElement</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> props<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">...</span>children<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>type 用于克隆的母体 React 元素
props 为克隆后生成的 React 元素添加新的 Props 或者覆盖从母体克隆出来的部分或者全部 props。
children 为新生成的 React 元素添加新的 children，取代从母体克隆出来的 children。</p> <h2 id="_13-如何告诉-react-它应该是编译生产环境版本"><a href="#_13-如何告诉-react-它应该是编译生产环境版本" class="header-anchor">#</a> 13.如何告诉 react 它应该是编译生产环境版本</h2> <p>通常情况下我们会使用 Webpack 的 DefinePlugin 方法来将 NODE_ENV 变量值设置为 production。编译版本中 React 会忽略 propType 验证以及其他的告警信息，同时还会降低代码库的大小，React 使用了 Uglify 插件来移除生产环境下不必要的注释等信息。</p> <h2 id="_14-react-中-key-的作用"><a href="#_14-react-中-key-的作用" class="header-anchor">#</a> 14.react 中 key 的作用</h2> <p>用于 diff 算法时作为组件的唯一标识：</p> <ul><li>key 属性的使用设计到 diff 算法中的同级节点的对比策略，当指定了 key 值时，key 值会作为当前组件的 id，diff 算法会根据这个 id 来进行匹配。在遍历新虚拟 dom 树时取出这个 key 值去老 dom 树中查找是否有组件，如果有，react 会认为当前组件只是位置发生了变化，并不会将旧的组件销毁，而是根据情况来更改当前组件的位置。</li> <li>如果没有设置 key 值，react 会默认将当前组件数据源的 index 作为默认的 key 值，会出现混乱，不利于 diff。</li></ul> <h2 id="_15-react-中-state-和-props-的区别"><a href="#_15-react-中-state-和-props-的区别" class="header-anchor">#</a> 15.react 中 state 和 props 的区别</h2> <ol><li>props 用于组件之间传递参数，父组件可以将自身的 state 通过属性传递的方式传给子组件，子组件通过 props 获取，在子组件中 props 是只读的，无法修改父组件传递来的 props</li> <li>state 是组件内部的状态数据，组件内部不能直接修改，要通过 setState 来实现对 state 的修改，修改 state 会实现组件的重新渲染。</li></ol> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div> <div class="gitalk-container"><div id="gitalk-container"></div></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/test/aboutVue.html" class="prev">
        Vue 相关
      </a></span> <span class="next"><a href="/test/math.html">
        算法相关
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b7abec6d.js" defer></script><script src="/assets/js/2.abe78d93.js" defer></script><script src="/assets/js/18.a8bc42d5.js" defer></script><script src="/assets/js/5.f990928a.js" defer></script>
  </body>
</html>
